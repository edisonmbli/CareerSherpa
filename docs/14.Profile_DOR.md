# Profile Page DOR（Definition of Ready）

## 页面结构
- 路由：`app/[locale]/profile/page.tsx`（Server Component）
- Tabs：`assets`｜`billing`
- 资产 Tab：两张 `AppCard`
  - 通用简历（必选）：标题/描述、上传控件、状态展示（Badge：IDLE/PENDING/COMPLETED/FAILED）
  - 详细履历（可选）：同结构，描述强调“上下文越丰富越好”
- 账单 Tab：当前余额与“上线后通知我”表单（M10 预留）

## 交互与五态（资产上传）
- Idle：主按钮可点击；上传控件可用；提示文案 muted
- Queued：`toast.warning('金币不足，已转入免费队列')`（当 isFree=true）
- Processing（轮询）：显示 `Progress` 与“正在解析...”文案；禁用按钮
- Success：Badge=COMPLETED；`toast.success('简历解析完成')`；按钮可用
- Failed：Badge=FAILED；`toast.error('任务失败，金币已返还')`；按钮可用

## 触发与服务端
- 上传控件仅接受 `application/pdf`
- 说明：仅支持文本型 PDF（扫描件/图片不支持），以 `text-muted-foreground` 呈现
- Server Actions：
  - 复用 `lib/actions/resume.actions.ts`（`uploadResumeAction` / `uploadDetailedResumeAction`）
  - 或新增资产专用 Action（接收 FormData、调用 `lib/utils/file-processor.ts` 解析文本后委派到现有 Action）
- 队列与返还：调用项目现有生产者（pushTask）、消费者（batch worker），失败自动返还金币

## 轮询
- Hook：`lib/hooks/useTaskPolling.ts`（interval=3000, maxAttempts=20）
- API：`GET /api/task-status?taskId=...&taskType=...`（返回 `PENDING|COMPLETED|FAILED`）
- 成功/失败回调：刷新 Server Component 数据

## 文案与 i18n
- 所有文案（标题/描述/按钮/提示/空状态/Toast）均来自字典（`getDictionary(locale)`）
- 禁止硬编码文本；切换 locale 时页面刷新加载对应字典

## 可访问性与移动端
- 对比度：浅蓝主色在按钮与文本场景下对比度 ≥ 4.5
- 焦点环：`focus-visible` 明显；键盘操作可达
- 移动端：Tabs 置顶，资产卡片纵向堆叠；轮询状态不强制全屏，用户可离开页面

## 门禁清单（PR Checklist）
- [ ] 使用 `AppCard` + `p-6`、卡片之间 `gap-6/8`
- [ ] 仅文本型 PDF 提示已显示，控件限制 MIME
- [ ] 五态覆盖完整，禁用态合理
- [ ] Toaster 提示规范（free/queuefull/success/error）
- [ ] 文案全部从字典加载
- [ ] 移动端布局与 a11y 通过

## DoD（执行计划 3.M8 对齐）
- 新用户上传 PDF → 立即显示 Toast 与轮询 → 最终 Badge=COMPLETED，Quota 正确更新；无硬编码文案